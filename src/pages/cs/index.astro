---
import BaseLayout from '../../layouts/BaseLayout.astro';
import '../../styles/global.css';
import Navigation from '../../components/react/Navigation.tsx';
import LanguageSwitcher from '../../components/LanguageSwitcher.astro';
import ProjectTimeline from '../../components/react/ProjectTimeline.tsx';
import AIPlayground from '../../components/react/AIPlayground.tsx';
import OpportunityForm from '../../components/react/OpportunityForm.tsx';
import { Image } from 'astro:assets';
import portrait from '../../assets/profilovka_md.png';
import { getCollection } from 'astro:content';
import { getTranslatedContent, useTranslations } from '../../i18n/ui';

const projects = (await getCollection('projects')).sort((a, b) => a.data.order - b.data.order);

// Get Czech translations
const lang = 'cs';
const { hero, highlightStats, skillClusters, timelineEntries, aiIdeas, contactLinks } = getTranslatedContent(lang);
const t = useTranslations(lang);

// Map technology names to vocabulary page slugs
const techSlugMap: Record<string, string> = {
  'React': 'react-typescript',
  'TypeScript': 'react-typescript',
  'Redux': 'redux-state-management',
  'Zustand': 'zustand-state-management',
  'Material UI': 'material-ui-design-system',
  'MongoDB': 'mongodb-react-dashboard',
  'Docker': 'docker-github-actions-cicd',
  'Playwright': 'playwright-testing',
  'Next.js': 'nextjs-enterprise',
  'React Hook Form': 'react-hook-form',
  'Formik': 'formik-multistep-forms',
  'PostgreSQL': 'postgresql-react',
  'GraphQL': 'graphql-integration',
  'Gatsby': 'gatsby-graphql'
};
---

<style>
  .keyword-highlight {
    background: linear-gradient(180deg, transparent 60%, rgba(var(--accent-rgb), 0.2) 60%);
    font-weight: 500;
    text-decoration: none;
    color: inherit;
    transition: background 0.2s;
  }
  .keyword-highlight:hover {
    background: linear-gradient(180deg, transparent 50%, rgba(var(--accent-rgb), 0.35) 50%);
  }
</style>

<BaseLayout
  lang={lang}
  title="Marek Dolníček — React & TypeScript vývojář"
  description="Enterprise React vývojář budující škálovatelné interní portály a kritické aplikace s TypeScriptem, Material UI a moderními webovými technologiemi."
>
  <Navigation slot="navigation" client:load currentPath={Astro.url.pathname} lang={lang} />
  <LanguageSwitcher slot="language-switcher" />

  <section class="rounded-[32px] border border-white/10 bg-gradient-to-br from-white/10 to-transparent p-8 shadow-card">
    <div class="grid gap-8 lg:grid-cols-[2fr,0.5fr] lg:items-center">
      <div class="space-y-5">
        <p class="eyebrow">{hero.eyebrow}</p>
        <h1 class="text-4xl font-semibold text-white sm:text-5xl">{hero.title}</h1>
        <p class="text-xl text-slate-200">{hero.subtitle}</p>
        <p class="max-w-3xl text-lg text-slate-300">{hero.body}</p>
        <div class="flex flex-col gap-4 sm:flex-row sm:items-center">
          <a class="rounded-full bg-accent px-6 py-3 text-base font-semibold text-ink shadow-card transition hover:bg-accentMuted" href={hero.primaryCta.href}>
            {hero.primaryCta.label}
          </a>
          <a class="rounded-full border border-white/30 px-6 py-3 text-base font-semibold text-white transition hover:border-accent" href={hero.secondaryCta.href}>
            {hero.secondaryCta.label}
          </a>
        </div>
      </div>
      <figure class="relative overflow-hidden rounded-[32px] border border-white/15 bg-white/5 p-3 shadow-card">
        <div class="absolute inset-3 rounded-[28px] bg-gradient-to-b from-accent/30 to-transparent blur-3xl" aria-hidden="true"></div>
        <Image
          src={portrait}
          alt="Portrét Marka Dolníčka"
          class="relative z-10 h-full w-full rounded-[24px] object-cover"
          width={360}
          height={450}
          loading="lazy"
        />
        <figcaption class="mt-4 text-sm text-slate-400">
          Marek Dolníček — český frontend vývojář zaměřený na enterprise portály.
        </figcaption>
      </figure>
    </div>
    <div class="mt-8 grid gap-4 sm:grid-cols-3">
      {highlightStats.map((stat) => (
        <div class="surface-card">
          <p class="text-3xl font-semibold text-accent">{stat.value}</p>
          <p class="text-sm uppercase tracking-[0.25em] text-slate-400">{stat.label}</p>
        </div>
      ))}
    </div>
  </section>

  <section class="grid gap-6 lg:grid-cols-[2fr_1fr]">
    <div class="surface-card space-y-6">
      <div>
        <p class="eyebrow">{t('section.enterpriseReact')}</p>
        <h2 class="text-3xl font-semibold text-white">{t('section.systemsUsedDaily')}</h2>
      </div>
      <p class="text-lg text-slate-200" set:html={t('section.enterpriseDescription')
        .replace(/React a TypeScript/g, '<a href="/cs/vocabulary/react-typescript" class="keyword-highlight">React a TypeScript</a>')
        .replace(/GraphQL/g, '<a href="/cs/vocabulary/graphql-integration" class="keyword-highlight">GraphQL</a>')
        .replace(/Material UI/g, '<a href="/cs/vocabulary/material-ui-design-system" class="keyword-highlight">Material UI</a>')
        .replace(/CI\/CD/g, '<a href="/cs/vocabulary/docker-github-actions-cicd" class="keyword-highlight">CI/CD</a>')
      }></p>
      <ul class="grid gap-4 sm:grid-cols-3">
        {skillClusters.map((cluster) => (
          <li class="rounded-3xl border border-white/10 bg-white/5 p-4">
            <p class="text-sm font-semibold text-white">{cluster.name}</p>
            <ul class="mt-2 space-y-1 text-sm text-slate-300">
              {cluster.bullets.map((item) => (
                <li set:html={item
                  .replace(/React, Next\.js & Gatsby/g, '<a href="/cs/vocabulary/react-typescript" class="keyword-highlight">React</a>, <a href="/cs/vocabulary/nextjs-enterprise" class="keyword-highlight">Next.js</a> & Gatsby')
                  .replace(/Redux/g, '<a href="/cs/vocabulary/redux-state-management" class="keyword-highlight">Redux</a>')
                  .replace(/Formik/g, '<a href="/cs/vocabulary/formik-multistep-forms" class="keyword-highlight">Formik</a>')
                  .replace(/React Hook Form/g, '<a href="/cs/vocabulary/react-hook-form" class="keyword-highlight">React Hook Form</a>')
                  .replace(/Material UI/g, '<a href="/cs/vocabulary/material-ui-design-system" class="keyword-highlight">Material UI</a>')
                  .replace(/GraphQL/g, '<a href="/cs/vocabulary/graphql-integration" class="keyword-highlight">GraphQL</a>')
                  .replace(/PostgreSQL/g, '<a href="/cs/vocabulary/postgresql-react" class="keyword-highlight">PostgreSQL</a>')
                }></li>
              ))}
            </ul>
          </li>
        ))}
      </ul>
    </div>
    <AIPlayground client:visible ideas={aiIdeas} />
  </section>

  <section id="projects" class="space-y-6">
    <div class="space-y-4">
      <p class="eyebrow">{t('section.selectedProjects')}</p>
      <h2 class="text-3xl font-semibold text-white">{t('section.reactHeavySurfaces')}</h2>
    </div>
    <div class="grid gap-6 md:grid-cols-2">
      {projects.map((project) => (
        <article class="grid-panel flex flex-col gap-4" key={project.slug}>
          <div>
            <p class="text-sm uppercase tracking-[0.25em] text-slate-400">{project.data.role}</p>
            <h3 class="mt-2 text-2xl font-semibold text-white">{project.data.title}</h3>
            <p class="mt-2 text-slate-200">{project.data.summary}</p>
          </div>
          <div class="flex flex-wrap gap-2">
            {project.data.stack.map((tech) => {
              const slug = techSlugMap[tech];
              return slug ? (
                <a href={`/cs/vocabulary/${slug}`} class="pill keyword-highlight">{tech}</a>
              ) : (
                <span class="pill">{tech}</span>
              );
            })}
          </div>
          {project.data.link && (
            <a class="text-sm font-semibold text-accent underline underline-offset-4 transition hover:text-accentMuted" href={project.data.link}>
              Navštívit projekt →
            </a>
          )}
        </article>
      ))}
    </div>
  </section>

  <section id="timeline" class="space-y-4">
    <div class="space-y-4">
      <p class="eyebrow">{t('section.timeline')}</p>
      <h2 class="text-3xl font-semibold text-white">{t('section.careerMilestones')}</h2>
    </div>
    <ProjectTimeline client:visible entries={timelineEntries} />
  </section>

  <section class="grid gap-6 lg:grid-cols-2">
    <OpportunityForm client:visible lang={lang} />
    <div class="surface-card space-y-4">
      <p class="eyebrow text-accent">{t('contact.email')}</p>
      <h2 class="text-3xl font-semibold text-white">{t('contact.letsPair')}</h2>
      <p class="text-slate-200">
        {t('contact.description')}
      </p>
      <ul class="space-y-2 text-sm text-slate-200">
        {contactLinks.map((link) => (
          <li key={link.label} class="flex items-center justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3">
            <span>{link.label}</span>
            <a class="font-semibold text-accent" href={link.href}>{link.value}</a>
          </li>
        ))}
      </ul>
    </div>
  </section>
</BaseLayout>
